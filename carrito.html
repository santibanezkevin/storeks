<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tienda KS</title>
    <link rel="stylesheet" href="assets/styles/navbar.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../assets/styles/style.css" />
  </head>
  <body>
    <div id="navbar-container"></div>
    <script>
      // Espera a que el navbar esté cargado
      fetch("includes/navbar.html")
        .then((res) => res.text())
        .then(async (data) => {
          document.getElementById("navbar-container").innerHTML = data;

          // Verifica si el usuario está logueado
          const user = supabaseClient.auth.getUser
            ? (await supabaseClient.auth.getUser()).data.user
            : (await supabaseClient.auth.getSession()).data.session?.user;

          // Muestra/oculta según el estado de sesión
          if (user) {
            // Usuario logueado: oculta login, muestra logout
            document.getElementById("login-link").style.display = "none";
            document.getElementById("logout-link-li").style.display = "block";
          } else {
            // Usuario NO logueado: muestra login, oculta logout
            document.getElementById("login-link").style.display = "block";
            document.getElementById("logout-link-li").style.display = "none";
          }

          // Evento para cerrar sesión
          const logoutLink = document.getElementById("logout-link");
          if (logoutLink) {
            logoutLink.addEventListener("click", function (e) {
              e.preventDefault();
              cerrarSesion();
            });
          }
        });
    </script>

    <h1 class="text-center mt-5">Bienvenido al carrito</h1>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="assets/js/supabase.js"></script>
  </body>
</html>
